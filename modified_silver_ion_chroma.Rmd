---
title: "Modified Silver Ion Chroma"
author: "Tristan Caro"
date: "12/16/2020"
output:
  html_document:
    toc: true
    toc_float: true
    toc_depth: 3
---

# Silver Ion Chroma (12/15/2020)

## Summary

## Protocol

Derived from ["Supelco Discovery Ag-Ion SPE"](https://www.sigmaaldrich.com/catalog/product/supelco/54225u?lang=en&region=US) and comments from Seb & Jamie. This protocol provides a wider range of liquid phases with which to elute FAMEs.

1.  Set up Ag-Ion columns (SPE) over waste collection (40mL) vials.

2.  Condition SPE with 4mL acetone.

3.  Equilibrate with 4mL hexane.

4.  Load FAMES in 100µL hexane derived from sample extraction at a flow rate of 2-3 drops per second. Remove waste collection vials and replace with Fraction 1 (F1) collection vials.

5.  Elute **F1** with 4mL hexane.
    *F1 should rule out solvent carry-through.*

6.  Elute **F2** with 4mL hexane:acetone 99:1.

7.  Elute **F3** with 4mL hexane:acetone 96:4.

8.  Elute **F4** with 4mL hexane:acetone 90:10.

9.  Elute **F5** with 4mL acetone.

10. Evaporate all fractions at 40˚C under N2.

11. Reconstitute in 100µL cyclohexane prior to GC analysis.

**BAME Standard and Sample**

1.  Use TC-BAME3 (50µg BAME in 200µL: 0.25µg/µL or 10ng/µL per compound)

2.  Divide in half:
    Use 100µL as a **standard**.
    Use 100µL as a **sample.**
    *The column sees 100µL \* 10ng/µL = 1000ng (1µg) per compound).*

3.  **After** SPE, add PAIBE to each fraction (to conc of 10ng/µL), including BAME standard.

    -   From `100ng/1µL PAIBE`, add 10µL to each fraction (1000ng; 1µg) for a total volume of 100µL. (1000ng / 100µL = 10ng/µL)

**PAIBE**

1.  PAIBE donated from JM as 1mg/1mL (1µg/1µL) in cyclohexane.

2.  Remove 2mL of 1µg/1µL (2µg). Add to GC vial. Label `PAIBE 1µg/1µL`.

3.  Remove 100µL of 1µg/1µL (100ng). Add to GC vial. Dilute with 900µL cyclohexane for a total volume of 1mL. Label `PAIBE 100ng/1µL`.

## Results

```{r, include = FALSE}
# Libraries
library(tidyverse)
library(plotly)
library(ggrepel)

# Source
source(file.path("libs", "visualization.R"))
source(file.path("libs", "chromleon.R"))
```

### Data Import

```{r}
# Define path names and sample names
root <- "data/2020.12.15_TC_BAMES_AgionMod_DB1"
path_names <- list.files("data/2020.12.15_TC_BAMES_AgionMod_DB1")
sample_names <- path_names %>% 
  str_sub(start = 9, end = -5) %>% 
  str_replace("_100ul", "")
sample_names

# read_chromeleon_export is a sourced R function. See above.
all_data <-
  tibble(
    sample = sample_names,
    file = path_names,
    data = map(file.path(root, file), read_chromeleon_export),
    injection_details = map(data, "injection_details"),
    integration_results = map(data, "integration_results")
  ) %>% select(-data)

```

### Data Cleanup

```{r, warning = FALSE}
results <- all_data %>% 
  select(-injection_details) %>% 
  unnest(integration_results) %>% 
  filter(nchar(`Peak Name`) > 0) %>% 
  # major compound groups
  mutate(
    group = `Peak Name` %>% str_remove("\\d+-OH") %>% parse_number() %>% abs() %>% {paste0("C", .)} %>% factor()
  )

results <- results %>% 
  mutate(saturation = case_when(
    str_detect(`Peak Name`, "OH") ~ "n0 hydroxy",
    str_detect(`Peak Name`, "cyclo") ~ "n0 cyclo",
    str_detect(`Peak Name`, ":0") ~ "n0",
    str_detect(`Peak Name`, ":2") ~ "n2 cis",
    str_detect(`Peak Name`, "cis") ~ "n1 cis",
    str_detect(`Peak Name`, "trans") ~ "n1 trans",
    str_detect(`Peak Name`, "PAIBE") ~ "PAIBE"
    )
  )
```

### Overview Plot

```{r, echo = FALSE, warning=FALSE, fig.width=7, fig.height = 10}
plot_results <- results %>% 
  filter(!sample %in% c('cyclohex_blank1', 'cyclohex_blank2', 'cyclohex_blank3', 'cyclohex_blank4'))

factored_samples <- c('tcbames3','BAME_modagion_F1','BAME_modagion_F2','BAME_modagion_F3', 'BAME_modagion_F4', 'BAME_modagion_F5')

plot_results$sample_f = factor(plot_results$sample, levels=factored_samples)

p_tc_bames2 <- plot_results %>%
  ggplot() +
  aes(`Retention Time`, `Relative Height`, fill = saturation, key = `Peak Name`) +
  geom_bar(stat = 'identity', width = 0.1)+
  facet_wrap(~sample_f, ncol = 1, scales = "free_y") +
  ggtitle("BAMES Standard 10µg/µL") +
  theme_bw()

p_tc_bames2 %>% ggplotly(dynamicTicks = TRUE, tooltip = c("key", "x", "y"))
```

### Quantification

PAIBE was used as a quantification standard at 10ng/µL. This was meant to be comparable to the concentration of individual BAME compounds run through the column (10ng/µL per BAME, 250ng/µL total BAME).

```{results <- results %>%}
  group_by(sample) %>% 
  mutate(
    PAIBE_height = # PAIBE relative height value for given `sample`,
    rel_to_PAIBE = `Relative Height` * / PAIBE_height
    conc_ng_ul = rel_to_PAIBE * 10
  )

```

### 
